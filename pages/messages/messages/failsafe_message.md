---
title: Failsafe Message
keywords:  messaging, bundles, failsafe
tags: [fhir,messaging]
sidebar: overview_sidebar
permalink: failsafe_message.html
summary: "The FHIR profiles used for the Failsafe Message Event Message Bundle"
---


## Event Message Content

The Failsafe Message is generated by the National Failsafe Management Service (NFMS) once a trigger condition in the NFMS has been met, e.g. a NFMS rule evaluation indicates an expected intervention has not happened. The Failsafe message is carried within the event message as specified in the guidance on this page

## Bundle Structure

Specifies mandatory referencing within the Event Message Bundle.

The diagram below shows the referencing between FHIR resources within the event message bundle:

<div style="text-align:center; margin-bottom:20px" >
	<a href="images/messages/failsafe_message.png" target="_blank"><img src="images/messages/failsafe_message.png"></a>
</div>

## Event Life Cycle ##

For the Failsafe Message the messageEventType will always be set to “new”

## Resource Population Requirements and Guidance ##

The following requirements and resource population guidance should be followed in addition to the requirements and guidance outlined in the Generic Requirements page. 

## Resource Mapping Overview  ##

| Data Item                | FHIR resource element                                         | Notes                                                                                                                                                                                                    |
|--------------------------|---------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Originating Organisation | CareConnect-Organization-1.identifier (ODS Organisation Code) | This is the originating organisation – currently X26 (NHS Digital)                                                                                                                                       |
| Date and Time raised     | Event-MessageHeader-1.meta.lastUpdated                        | The date (and time if available) when the message was created                                                                                                                                            |
| Date and Time evaluated  | CareConnect-Task-1.authoredOn                                 | The date (and time if available) when the Failsafe rule was evaluated                                                                                                                                    |
| Identifier               | Task.identifier                                               | A publisher defined unique identifier (a UUID) for the Failsafe Message message instance, which must be included in any subsequent related Failsafe Message Response, to support traceability and audit. |
| Increment number         | Task.Extension-IncrementNumber                                | The number of the message that is being sent i.e. message 2                                                                                                                                              |
| Incomplete Element(s)    | CareConnect-Task.input.valueCodeableConcept                   | List of which elements are incomplete where they must be stated (i.e. NIPE).                                                                                                                             |
| Failsafe Rule Version    | Task.Extension-failsafeRuleVersion                            | The version of the failsafe rule that triggered the message                                                                                                                                              |


### [Bundle](http://hl7.org/fhir/STU3/StructureDefinition/Bundle)

The Bundle resource is the container for the event message and SHALL conform to the Bundle FHIR profile. 

| Resource Cardinality | 1..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| type | 1..1 | Fixed value: message |


### [Event-MessageHeader-1](https://fhir.nhs.uk/STU3/StructureDefinition/Event-MessageHeader-1)

The MessageHeader resource included as part of the event message SHALL conform to the Event-MessageHeader-1 constrained FHIR profile and the additional population guidance as per the table below: 

| Resource Cardinality | 1..1 |

| Element                         | Cardinality  | Additional Guidance                                                                                        |
|---------------------------------|--------------|------------------------------------------------------------------------------------------------------------|
| id                              | 1..1         | Globally unique identifier for the individual Failsafe Message, as a UUID                                  |
| meta.lastUpdated                | 1..1         | The dateTime when the message was generated.                                                               |
| extension(RoutingDemographics)  | 1..1         | Common to all EMS messages                                                                                 |
| extension(messageEventType)     | 1..1         | See the “Event Life Cycle” section above.                                                                  |
| event                           | 1..1         | A Failsafe Message event type from the EventType-1 valueSet(https://fhir.nhs.uk/STU3/ValueSet/EventType-1)  |
| focus                           | 1..1         | This will reference the CareConnect-Task-1 resource.                                                       |

### [CareConnect-Task-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Task-1)

The Task shall conform the CareConnect-Task-1 constrained FHIR profile and the additional guidance as per the table below: 

| Resource Cardinality | 1..1 |

| Element                     | Cardinality  | Additional Guidance                                                                                                                                                                                                                                                                                               |
|-----------------------------|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| extension(incrementNumber)  | 0..1 | The number of times the same Failsafe message event has been triggered for a Patient                                                                                                                                                                                                                                                                                                                  |
| extension(failsafeRuleVersion)  | 1..1 | The version of the business rule that triggered the message.                                                                                                                                                                                                                                                                                                                  |
| Identifier                  | 1..1         | A publisher defined unique identifier (a UUID) for the Failsafe Message message instance, which must be included in any subsequent related Failsafe Message Response, to support traceability and audit.                                                                                                                                                                                                                                                                          |
| status                      | 1..1         | A mandated element. Fixed to “requested”.                                                                                                                                                                                                                                                                         |
| intent                      | 1..1         | A mandated element. Fixed to “proposal”.                                                                                                                                                                                                                                                                             |
| code                        | 1..1         | A repeat of the event code                                                                                                                                                                                                                                                                                        |
| for                         | 1..1         | A link to the patient                                                                                                                                                                                                                                                                                             |
| authoredOn                  | 1..1         | The date and time at which the rule was evaluated.                                                                                                                                                                                                                                                                |
| requester.agent             | 1..1         | A link to the organisation who requested the task                                                                                                                                                                                                                                                                 |
| input                       | 0..*         | Used to hold “incomplete elements” that need completing to complete the event.                                                                                                                                                                                                                                    |
| Input.type                  | 1..1         | A mandated element (when using the input BackboneElement to represent incomplete elements, otherwise it is omitted). The text element of the CodeableConcept is used & fixed to “Incomplete element”                                                                                                              |
| Input.valueCodeableConcept  | 0..*         | Allows receiver to identify which resource / test in the overall intervention has not been completed.   For Child Health, this uses the list of SNOMED codes for incomplete each element outcome.  There is no binding for this element. Failsafe will assign the code and codeSystem when creating the message.  |

### [CareConnect-Organization-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1)

The Organization resources included in the bundle SHALL conform to the CareConnect-Organization-1 constrained FHIR profile and the additional population guidance as per the table below. Both Organization references (Event-MessageHeader-1.responsible & CareConnect-Task-1.requester.agent) reference the same Organization. 

| Resource Cardinality | 1..1 |

| Element     | Cardinality  | Additional Guidance                                                                                          |
|-------------|--------------|--------------------------------------------------------------------------------------------------------------|
| identifier  | 1..*         | The organization issuing the task – currently fixed to “X26” using the odsOrganizationCode identifier slice.  |
| name        | 1..1         | A human readable name for the organization is "CURRENTLY" fixed to “NHS DIGITAL”                                         |

### [CareConnect-Patient-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Patient-1)

The Patient resource included as part of the event message SHALL conform to the CareConnect-Patient-1 constrained FHIR profile and the additional population guidance as per the table below: 

| Resource Cardinality | 1..1 |

| Element          | Cardinality  | Additional Guidance                                                                                                                                                             |
|------------------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| identifier       | 1..1         | Patient NHS Number SHALL be included within the NHSNumberidentifier slice                                                                                                       |
| name (official)  | 1..1         | Patients name as registered on PDS, included within the resource as the official name element slice                                                                             |
| birthDate        | 1..1         | The patient birth date shall be included in the patient resource. If the time of birth is known, then the birthDateTime extension should also be sent along with the birthDate  |













## Examples

<div class="tabPanel">

	<div class="tabHeadings">
		<span class="tabHeading" id="new">FailsafeMessage</span>
		<span class="tabHeading" id="update">FailsafeMessageWithIncompleteElements</span>
	</div>
	
	<div class="tabBodies">
	
		<div class="tabBody" id="newBody" markdown="span">
			```{% include_relative examples/FailsafeMessage.xml %}```
		</div>
		
		<div class="tabBody" id="updateBody" markdown="span">
			```{% include_relative examples/FailsafeMessageWithIncompleteElements.xml %}```
		</div>
		
	</div>
</div>

